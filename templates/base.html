{% import "_macros.html" as macros %}
<!DOCTYPE html>
<html lang="{{ lang | default(value=config.default_language) }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ config.title }}{% endblock title %}</title>
    <link rel="stylesheet" href="{{ get_url(path="style.css") }}">
    <style>
        :root {
            --theme-color: {{ config.extra.theme_color | default(value="#ff2d55") }};
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="{{ get_url(path="js/background.js") }}"></script>
    <script src="{{ get_url(path="js/theme-toggle.js") }}"></script>
</head>
<body>
    <div id="bg-canvas-container" 
         data-colors='{{ config.extra.background_colors | json_encode() | safe }}'
         style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; overflow: hidden;">
    </div>
    <div class="app-layout">
        <aside class="sidebar">
            <div class="card menu-card">
                <div class="menu-section">
                    <div class="search-bar">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                        <span>{{ macros::t(key="search") }}</span>
                    </div>
                    
                    <nav class="main-nav">
                        <ul>
                            <li>
                                <a href="{{ get_url(path="@/_index.md") }}" class="{% if current_path == "/" %}active{% endif %}">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                                    {{ macros::t(key="home") }}
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
                <div class="menu-section">
                    <h3 class="section-title">{{ macros::t(key="section") }}</h3>
                    <nav class="sub-nav">
                        <ul>
                            <li>
                                <a href="{{ get_url(path="@/blog/_index.md") }}" class="{% if current_path is starting_with("/blog/") %}active{% endif %}">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                                    {{ macros::t(key="blog") }}
                                </a>
                            </li>
                            <li>
                                <a href="{{ get_url(path="@/music/_index.md") }}" class="{% if current_path is starting_with("/music/") %}active{% endif %}">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></svg>
                                    {{ macros::t(key="music") }}
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>

                <div class="menu-section">
                    <h3 class="section-title">Library</h3>
                    <nav class="sub-nav">
                        <ul>
                            <li>
                                <a href="{{ config.base_url }}/tags">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
                                    {{ macros::t(key="tags") }}
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                                    {{ macros::t(key="recent") }}
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
                
                <div class="sidebar-footer">
                    <button id="theme-toggle" class="theme-toggle-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <span class="theme-text" 
                              data-dark="{{ macros::t(key="dark_mode") }}"
                              data-light="{{ macros::t(key="light_mode") }}">{{ macros::t(key="dark_mode") }}</span>
                    </button>
                </div>
            </div>
        </aside>

        <main class="main-content">
            {% block content %}{% endblock content %}
        </main>
    </div>
</body>
</html>
